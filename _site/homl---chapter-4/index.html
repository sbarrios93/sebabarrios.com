<!doctype html><html domain=.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content="default-src 'self';object-src 'none';script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com/ https://gist.github.com/ https://www.googletagmanager.com/ https://www.google-analytics.com https://cdn.jsdelivr.net;connect-src 'self' https://www.google-analytics.com https://api.github.com;style-src 'self' https://fonts.googleapis.com/ https://use.fontawesome.com/ 'unsafe-inline' https://github.githubassets.com/ https://cdn.jsdelivr.net https://rsms.me;img-src 'self' data:;font-src 'self' https://fonts.gstatic.com/ https://use.fontawesome.com/ https://cdn.jsdelivr.net https://rsms.me" http-equiv=Content-Security-Policy><link href=/favicon.svg rel=icon type=image/svg+xml><link href=/src/css/main.css rel=stylesheet><meta content=#f9c412 name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>Chapter 4 - Linear Regression Models</title><meta content="Chapter 4 - Linear Regression Models" prefix="og: http://ogp.me/ns#" property=og:title><meta content="This chapter focuses on Linear Regression Models. There's basically two ways to train a linear regression model: Closed-form equation:..." name=description><meta content="This chapter focuses on Linear Regression Models. There's basically two ways to train a linear regression model: Closed-form equation:..." prefix="og: http://ogp.me/ns#" property=og:description><meta content=summary_large_image name=twitter:card><meta content=@itsmeseba name=twitter:site><meta content=@itsmeseba name=twitter:creator><meta content=https://sebabarrios.com/img/frontpage.png prefix="og: http://ogp.me/ns#" property=og:image><meta content=article prefix="og: http://ogp.me/ns#" property=og:type><link href=https://sebabarrios.com/homl---chapter-4/ rel=canonical><meta content=https://sebabarrios.com/homl---chapter-4/ prefix="og: http://ogp.me/ns#" property=og:url><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="Sebastián Barrios"><link href=/ rel=preconnect crossorigin><link href=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw><script src=https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js defer crossorigin=anonymous integrity=sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH></script><link href=/fontello/css/fontello.css rel=stylesheet><link href=/src/tailwind/style.css rel=stylesheet><style>body {
      visibility: hidden;
      opacity: 0;
    }</style><noscript><style>body {
        visibility: visible;
        opacity: 1;
      }</style></noscript><script csp-hash>if (/Mac OS X/.test(navigator.userAgent)) 
      document
        .documentElement
        .classList
        .add('apple')</script><style>@charset "UTF-8";
@import url("https://rsms.me/inter/inter.css");
/*! purgecss start ignore */
body {
  --color-blue: #3e7bfa;
  --color-green: #0ab534;
  --color-yellow: #ffc342;
  --color-invert: #000;
  --color-faded: #555;
  --color-faded-invert: #bbb;
  --font-color: #222;
  --color-background: #fafafd;
  --color-background-post: #fafafd;
  --font-bold-color: #222;
  --font-bold-color-weight: 600;
  --code-bg: #fff;
  --code-bd: #e4e2e2;
  --code-inline-text: #067b26;
  --code-inline-background: #ececec;
  --code-inline-bd: 1px solid #ddd;
  --a-list-homepage: #222;
  --a-list-homepage-bd: #cacaca;
  --font-a: #0b74cd;
  --a-hover: #222;
  --filter-invert: invert(1);
  --toc-title: #333;
  --toc-title-bd: #ccc;
  --toc-appendix: #545454;
  --heading-color: #333;
  --badge-black-bg: #f3f3f3;
  --badge-black-bd: #ddd;
  --table-bg: #e8e8e8;
  --badge-green: #0ab534;
  --badge-blue: #2f55c1;
  --color-bg-nav: #fafafd;
}

body.dark-theme {
  --color-blue: #6698ff;
  --color-green: #86f7a2;
  --color-yellow: #ffd479;
  --color-invert: #fff;
  --color-faded: #bbb;
  --color-faded-invert: #555;
  --font-color: #28293D;
  --color-background: #1c1c28;
  --color-background-post: #1c1c28;
  --font-bold-color: #8cc8ff;
  --font-bold-color-weight: 600;
  --code-bg: #2f3240;
  --code-bd: #3b3e54;
  --code-inline-text: #fff;
  --code-inline-background: #6b444245;
  --code-inline-bd: 1px solid #444;
  --a-list-homepage: #ddd;
  --a-list-homepage-bd: rgba(255, 255, 255, 0.14);
  --font-a: #ffd479;
  --a-hover: #fff;
  --filter-invert: invert(0);
  --toc-title: #f5d3a7;
  --toc-title-bd: #555;
  --toc-appendix: #a2a2a2;
  --heading-color: #28293D;
  --badge-black-bg: #343642;
  --badge-black-bd: #444;
  --table-bg: #2f3240;
  --badge-green: #009023;
  --badge-blue: #2f55c1;
  --color-bg-nav: #1c1c28;
}

/*! purgecss end ignore */
@supports (font-variation-settings: normal) {
  html {
    font-family: "Inter var", sans-serif;
  }
}
/* fira-code-300 - latin */
@font-face {font-display:swap;
  font-family: "Fira Code";
  font-style: normal;
  font-weight: 300;
  src: url("/fonts/fira-code/fira-code-v10-latin-300.eot");
  /* IE9 Compat Modes */
  src: local(""), url("/fonts/fira-code/fira-code-v10-latin-300.eot?#iefix") format("embedded-opentype"), url("/fonts/fira-code/fira-code-v10-latin-300.woff2") format("woff2"), url("/fonts/fira-code/fira-code-v10-latin-300.woff") format("woff"), url("/fonts/fira-code/fira-code-v10-latin-300.ttf") format("truetype"), url("/fonts/fira-code/fira-code-v10-latin-300.svg#FiraCode") format("svg");
  /* Legacy iOS */
}
/* fira-code-500 - latin */
@font-face {font-display:swap;
  font-family: "Fira Code";
  font-style: normal;
  font-weight: 500;
  src: url("/fonts/fira-code/fira-code-v10-latin-500.eot");
  /* IE9 Compat Modes */
  src: local(""), url("/fonts/fira-code/fira-code-v10-latin-500.eot?#iefix") format("embedded-opentype"), url("/fonts/fira-code/fira-code-v10-latin-500.woff2") format("woff2"), url("/fonts/fira-code/fira-code-v10-latin-500.woff") format("woff"), url("/fonts/fira-code/fira-code-v10-latin-500.ttf") format("truetype"), url("/fonts/fira-code/fira-code-v10-latin-500.svg#FiraCode") format("svg");
  /* Legacy iOS */
}
/* fira-code-regular - latin */
@font-face {font-display:swap;
  font-family: "Fira Code";
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/fira-code/fira-code-v10-latin-regular.eot");
  /* IE9 Compat Modes */
  src: local(""), url("/fonts/fira-code/fira-code-v10-latin-regular.eot?#iefix") format("embedded-opentype"), url("/fonts/fira-code/fira-code-v10-latin-regular.woff2") format("woff2"), url("/fonts/fira-code/fira-code-v10-latin-regular.woff") format("woff"), url("/fonts/fira-code/fira-code-v10-latin-regular.ttf") format("truetype"), url("/fonts/fira-code/fira-code-v10-latin-regular.svg#FiraCode") format("svg");
  /* Legacy iOS */
}
/* fira-code-600 - latin */
@font-face {font-display:swap;
  font-family: "Fira Code";
  font-style: normal;
  font-weight: 600;
  src: url("/fonts/fira-code/fira-code-v10-latin-600.eot");
  /* IE9 Compat Modes */
  src: local(""), url("/fonts/fira-code/fira-code-v10-latin-600.eot?#iefix") format("embedded-opentype"), url("/fonts/fira-code/fira-code-v10-latin-600.woff2") format("woff2"), url("/fonts/fira-code/fira-code-v10-latin-600.woff") format("woff"), url("/fonts/fira-code/fira-code-v10-latin-600.ttf") format("truetype"), url("/fonts/fira-code/fira-code-v10-latin-600.svg#FiraCode") format("svg");
  /* Legacy iOS */
}
/* fira-code-700 - latin */
@font-face {font-display:swap;
  font-family: "Fira Code";
  font-style: normal;
  font-weight: 700;
  src: url("/fonts/fira-code/fira-code-v10-latin-700.eot");
  /* IE9 Compat Modes */
  src: local(""), url("/fonts/fira-code/fira-code-v10-latin-700.eot?#iefix") format("embedded-opentype"), url("/fonts/fira-code/fira-code-v10-latin-700.woff2") format("woff2"), url("/fonts/fira-code/fira-code-v10-latin-700.woff") format("woff"), url("/fonts/fira-code/fira-code-v10-latin-700.ttf") format("truetype"), url("/fonts/fira-code/fira-code-v10-latin-700.svg#FiraCode") format("svg");
  /* Legacy iOS */
}
/* Color customization */
* {
  border: 0;
  box-sizing: border-box;
}

:root {
  font-size: 15px;
}

/*! purgecss start ignore */
.fontello-icon:before {
  margin-left: 0 !important;
}

/*! purgecss end ignore */
share-widget {
  position: fixed;
  right: 20px;
  bottom: 20px;
  opacity: 0.9;
}
share-widget div {
  width: 30px;
  height: 30px;
  background-image: url("/img/share.svg");
  background-repeat: no-repeat;
  background-position: center;
}

.apple share-widget div {
  background-image: url("/img/share-apple.svg");
}

share-widget button {
  margin: 0;
}
share-widget button:active {
  transform: scale(1.2);
}

html {
  -webkit-text-size-adjust: 100%;
  font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
  font-size: 15px;
}

@supports (font-variation-settings: normal) {
  html {
    font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
  }
}
body {
  font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
  background: var(--color-background);
  color: var(--font-color);
  margin: 0;
  font-size: 15px;
}

.test-dead-code-elimination-sentinel {
  color: red;
}

/*
  Make image rasterization lazy. This means that e.g. the cost of the
  blurry placeholder is never paid if images load before entering
  the viewport.
  Context
  - https://web.dev/content-visibility/#skipping-rendering-work-with-content-visibility
 */
main img {
  content-visibility: auto;
}

b,
strong {
  font-weight: var(--font-bold-color-weight);
  color: var(--font-bold-color);
}

dialog {
  background-color: #8dff80;
  position: fixed;
  opacity: 0.9;
}

small {
  font-size: 80%;
}

sub {
  bottom: -0.25em;
}

sup {
  top: -0.5em;
}

[type=checkbox],
[type=radio] {
  box-sizing: border-box;
  padding: 0;
}

[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button {
  height: auto;
}

[type=search] {
  -webkit-appearance: textfield;
  outline-offset: -2px;
}
[type=search]::-webkit-search-decoration {
  -webkit-appearance: none;
}

::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit;
}

mark {
  color: inherit;
  padding: 0;
  background-color: transparent;
  box-shadow: inset 0 -5px 0 #ffd479;
}

a.no-effect:hover {
  border-bottom: none;
}
a.no-color {
  color: var(--font-color) !important;
}
a strong,
a b {
  color: var(--font-a);
}
a strong:hover,
a b:hover {
  color: var(--a-hover);
}

hr {
  border-bottom: 1px solid #eee;
}

img {
  max-width: 100%;
}

.filter-invert {
  filter: var(--filter-invert);
}

main {
  margin: 0 auto;
}

.list-of-post {
  list-style: none;
  padding-left: 0;
  margin-bottom: 0;
}
.list-of-post .fontello-icon {
  margin-left: -25px;
}
.list-of-post .fontello-icon::before {
  opacity: 0.75;
}
.list-of-post li {
  margin-bottom: 10px !important;
  padding-right: 10px;
  padding-left: 25px;
  width: 100%;
}
.list-of-post li a {
  color: var(--a-list-homepage);
  border-bottom: 2px dotted var(--a-list-homepage-bd);
}
.list-of-post li:hover {
  cursor: pointer;
}
.list-of-post li:hover a {
  border-color: var(--font-a);
  color: var(--color-invert);
}
.list-of-post li:hover::before {
  opacity: 1;
}

.note-type-indicator {
  font-size: 0.95rem;
  color: var(--color-faded);
  margin: 0;
  font-style: italic;
  padding-top: 10px;
  border-top: 1px solid var(--toc-title-bd);
}
.note-type-indicator span {
  margin-right: 5px;
}
.note-type-indicator span:last-child {
  margin-right: 0;
}

@media (min-width: 1500px) {
  .wide {
    width: 1500px;
  }
}

.normal {
  padding: 0 15px;
  width: 100%;
}
@media (min-width: 915px) {
  .normal {
    width: 900px;
  }
}

@media (min-width: 1200px) {
  .ex-normal {
    width: 1000px;
  }
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
}

h1 {
  font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
  font-size: 27px;
}

h2 {
  font-size: 22.5px;
}

h3 {
  font-size: 19.575px;
}

h4 {
  font-size: 17.6175px;
}

.page-note {
  counter-reset: h2counter;
}
.page-note > h2,
.page-note h3,
.page-note h4 {
  font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
  color: var(--heading-color);
}
.page-note > h2:hover .direct-link,
.page-note h3:hover .direct-link,
.page-note h4:hover .direct-link {
  display: inline-block;
}
.page-note > h2:hover a:hover,
.page-note h3:hover a:hover,
.page-note h4:hover a:hover {
  color: var(--font-a);
}
.page-note > .h2-wrapper {
  border-radius: 7px;
  height: fit-content;
  background-image: linear-gradient(to left top, #383c4e, #343748, #303342, #2c2e3c, #282a36);
  padding: 0.1rem 1.5rem 0.5rem 1.5rem;
  margin-bottom: 33.75px;
  position: relative;
}
.page-note > .h2-wrapper::before {
  display: block;
  content: "";
  background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pjxzdmcgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIHZpZXdCb3g9IjAgMCA1MDAgNTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMwMCwzMDApIj48cGF0aCBkPSJNODEuNSwtMTM0LjFDOTcuNywtMTE2LjMsOTcuNSwtODAuNCw4OS42LC01My44QzgxLjcsLTI3LjIsNjYuMSwtMTAsODAuNywyNC4yQzk1LjQsNTguMywxNDAuMywxMDkuNCwxMzYuOSwxMjUuNEMxMzMuNiwxNDEuNSw4MiwxMjIuNiw0My41LDEyMS45QzUsMTIxLjIsLTIwLjUsMTM4LjgsLTM5LjQsMTMzLjVDLTU4LjMsMTI4LjMsLTcwLjcsMTAwLjIsLTg3LDc3LjVDLTEwMy4zLDU0LjksLTEyMy40LDM3LjgsLTE0Mi4xLDEwLjlDLTE2MC45LC0xNiwtMTc4LjIsLTUyLjcsLTE3OC4yLC05My4zQy0xNzguMSwtMTMzLjksLTE2MC43LC0xNzguNCwtMTI4LjEsLTE4OC43Qy05NS41LC0xOTksLTQ3LjgsLTE3NSwtNy42LC0xNjMuMkMzMi42LC0xNTEuNCw2NS4yLC0xNTEuOCw4MS41LC0xMzQuMVoiIGZpbGw9IiNGMEREM0UiLz48L2c+PC9zdmc+);
  background-repeat: no-repeat;
  height: 100px;
  width: 100px;
  opacity: 0.25;
  position: absolute;
  top: -15px;
  left: -20px;
  filter: hue-rotate(130deg);
}
.page-note > .h2-wrapper > h2, .page-note > .h2-wrapper > h3 {
  color: #fff;
}
.page-note > .h2-wrapper > h3 {
  border-bottom: 1px solid #4d526b;
  padding-bottom: 5px;
}
.page-note > h2 {
  font-size: 22.5px;
  margin: 33.75px 0 18px 0;
  border-bottom: 1px dashed var(--toc-title-bd);
  padding-bottom: 5px;
}
.page-note > h2 + h3 {
  margin-top: -0.5rem;
}
.page-note > h3 {
  font-size: 19.575px;
  margin-bottom: 18px;
  margin-top: 33.75px;
}
.page-note > h3 + h4 {
  margin-top: -0.5rem;
}
.page-note > h4 {
  font-size: 17.6175px;
  margin-bottom: 18px;
  margin-top: 33.75px;
}
.page-note .direct-link {
  display: none;
  color: #777;
  border-bottom: none;
  margin-left: 3px;
}
.page-note pre + h2, .page-note pre + h3, .page-note pre + h4,
.page-note .code-output-equal + h2,
.page-note .code-output-equal + h3,
.page-note .code-output-equal + h4,
.page-note .code-output-flex + h2,
.page-note .code-output-flex + h3,
.page-note .code-output-flex + h4 {
  margin-top: 33.75px;
}
.page-note h1 {
  counter-reset: h2counter;
}
.page-note h2 {
  counter-reset: h3counter;
}
.page-note h3 {
  counter-reset: h4counter;
}
.page-note h2:before {
  content: counter(h2counter) ".  ";
  counter-increment: h2counter;
}
.page-note h3:before {
  content: counter(h2counter) "." counter(h3counter) ".  ";
  counter-increment: h3counter;
}
.page-note h4:before {
  content: counter(h2counter) "." counter(h3counter) "." counter(h4counter) ".  ";
  counter-increment: h4counter;
}

/*! purgecss start ignore */
.page-index .main-cats {
  flex: 1;
  padding-right: 1rem;
}
.page-index .main-cats > .category-wrapper {
  padding-bottom: 1.5rem;
}
.page-index .main-cats > .category-wrapper > .category {
  border: 1px solid var(--code-bd);
  border-radius: 7px;
  height: fit-content;
  background: var(--code-bg);
  padding: 1.5rem 1.5rem;
  box-shadow: 8px 14px 38px #272c310f, 1px 3px 8px #272c3108;
}
.page-index .toc-index-container {
  position: sticky;
  top: 60px;
  height: fit-content;
  width: fit-content;
}
.page-index .toc-index-container .toc-index h3 {
  margin: 0;
  padding-bottom: 5px;
  border-bottom: 1px solid var(--toc-title-bd);
  margin-bottom: 10px;
  font-size: 1.15rem;
  color: var(--toc-title);
}
.page-index .toc-index-container .toc-index ul {
  padding-left: 0;
  margin: 0;
  list-style: none;
}
.page-index .toc-index-container .toc-index ul i {
  color: var(--color-invert);
}
.page-index .toc-index-container .toc-index ul i::before {
  font-weight: normal;
}
.page-index .toc-index-container .toc-index ul li {
  margin-bottom: 5px;
}
.page-index .toc-index-container .toc-index .toc-active > a {
  font-weight: normal;
  color: var(--font-a) !important;
}
.page-index .toc-index-container .appendix-toc {
  padding: 5px 10px;
  margin-top: 1rem;
  font-size: 85%;
  width: 100%;
  color: var(--toc-appendix);
  border: 1px solid var(--toc-title-bd);
  display: flex;
  flex-direction: column;
}
@media (max-width: 991px) {
  .page-index .main-cats {
    flex: 1 1 100%;
    order: 2;
    padding-right: 0;
  }
  .page-index .toc-index-container {
    flex: 1 1 100%;
    order: 1;
    position: inherit;
  }
  .page-index .toc-index-container .toc-index {
    border: 3px double var(--color-faded);
    padding: 15px;
  }
  .page-index .toc-index-container ul {
    column-count: 3;
    -webkit-column-count: 3;
    -moz-column-count: 3;
    -moz-column-count: 3;
  }
  .page-index .toc-index-container .appendix-toc {
    align-items: center;
    margin-bottom: 1rem;
    margin-top: 2rem;
    border: 0;
    padding: 0;
    flex-direction: row;
  }
  .page-index .toc-index-container .appendix-toc div {
    margin-right: 10px;
  }
  .page-index .toc-index-container .appendix-toc div:last-child {
    margin: 0;
  }
}
@media (max-width: 767px) {
  .page-index .toc-index ul {
    column-count: 2;
    -webkit-column-count: 2;
    -moz-column-count: 2;
    -moz-column-count: 2;
  }
}
@media (max-width: 575px) {
  .page-index .toc-index ul {
    column-count: 1;
    -webkit-column-count: 1;
    -moz-column-count: 1;
    -moz-column-count: 1;
  }
}

.category {
  width: 100%;
}
.category h2 {
  font-size: 1.55rem;
  margin-top: 0;
  color: var(--heading-color);
}
.category h2 i {
  margin-right: 5px;
}
.category .list-homepage {
  column-count: 1;
  -webkit-column-count: 1;
  -moz-column-count: 1;
  -moz-column-count: 1;
}
@media (min-width: 768px) {
  .category .list-homepage {
    column-count: 2;
    -webkit-column-count: 2;
    -moz-column-count: 2;
    -moz-column-count: 2;
  }
}
@media (min-width: 992px) {
  .category .list-homepage {
    column-count: 3;
    -webkit-column-count: 3;
    -moz-column-count: 3;
    -moz-column-count: 3;
  }
}

.page-index header .header-index {
  padding-right: 0;
  padding-right: 1rem;
  align-items: unset;
  text-align: unset;
}
.page-index header .header-index h1 {
  font-size: calc(1.875rem + 1.5vw);
  font-weight: 800;
}
@media (max-width: 767px) {
  .page-index header .header-index h1 {
    padding-left: 0.5rem;
  }
}
.page-index header .header-index h2 {
  font-size: calc(1.3rem + 1.5vw);
  font-weight: 700;
  margin-top: 0.1rem;
}
.page-index header .header-index p {
  max-width: 70rem;
  font-size: 1.1rem;
  line-height: 1.7rem;
  text-justify: distribute-all-lines;
}
.page-index header .header-index p.intro {
  margin-top: 0;
}
.page-index header .header-logo {
  display: none;
}

/*! purgecss end ignore */
/* "Content-visibility: auto" move the images over the other elements
   Set z-index to keep the nav over the rasterized images */
header nav {
  z-index: 10;
}

#nav {
  z-index: 2;
  position: relative;
}

/*! purgecss start ignore */
header {
  color: #28293D;
}
header .header-container {
  width: 900px;
  padding: 5rem 1rem 1rem;
  max-width: 100%;
  display: flex;
  align-items: center;
  flex-direction: column;
  margin: 0 auto;
  text-align: center;
}
header h1 {
  font-size: 2.2rem;
  margin-bottom: 0;
  margin-top: 0;
}
header p {
  margin-top: 1rem;
}
header .header-logo {
  width: 55px;
  height: 55px;
  margin-bottom: 1rem;
  margin-left: auto;
  margin-right: auto;
}
header .header-logo img {
  width: 100%;
  height: 100%;
}
header #more-info {
  padding: 1rem;
}
header #more-info #note-tag {
  padding-bottom: 10px;
  border-bottom: 1px solid #444;
}
header #more-info #note-tag > a {
  color: #ffd479;
  margin-right: 10px;
}
header #more-info #note-tag > a::before {
  content: "#";
}
header #more-info #note-tag > a:hover {
  color: #fff;
  border-bottom-color: #ffd479;
}
header #more-info #last-modified {
  padding-top: 10px;
  font-style: italic;
}
header #more-info #last-modified a {
  color: #ffd479;
}
header #more-info #last-modified a:hover {
  color: #fff;
  border-bottom-color: #ffd479;
}

#tag-footer #note-tag > a::before {
  content: "#";
}

#reading-progress {
  z-index: 3;
  border-bottom: 1px solid #ffd479;
  width: 100vw;
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  transform: translate(-100vw, 0);
  will-change: transform;
  pointer-events: none;
}

.intro {
  font-size: 1.02rem;
}
.intro b,
.intro strong {
  color: #ffd479;
  font-weight: normal;
}
.intro a {
  color: #fff;
}

.job span {
  background: #ffd479;
  color: #000;
  padding: 3px 20px;
  border-radius: 15px;
  font-size: 1.02rem;
}

p.contact {
  width: 100%;
  text-align: center;
  margin-bottom: 22.5px;
  max-width: unset !important;
}
p.contact a {
  margin-right: 10px;
  margin-bottom: 10px;
}
p.contact a:last-child {
  margin-right: 0;
}
p.contact a:hover {
  color: #fff;
}

/*! purgecss end ignore */
/*! purgecss start ignore */
nav {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  padding: 0 1.5rem;
  transition: ease 0.5s;
  -webkit-transition: ease 0.5s;
}
nav nav #nav .nav-search .nav-search__input {
  padding-right: 1.5rem;
}
@media (max-width: 992px) {
  nav {
    padding: 0 1rem;
  }
  nav nav #nav .nav-search .nav-search__input {
    padding-right: 1rem;
  }
}
@media (max-width: 576px) {
  nav {
    padding: 0 0.5em;
  }
  nav nav #nav .nav-search .nav-search__input {
    padding-right: 0.5rem;
  }
}
nav #nav {
  display: -ms-flexbox;
  display: flex;
  -ms-flex-align: center;
  align-items: center;
}
nav #nav a {
  white-space: nowrap;
  margin-right: 15px;
  display: flex;
  align-items: center;
  padding: 0 0.5rem;
  font-size: 1.1rem;
  white-space: nowrap;
}
nav #nav a img {
  margin-right: 5px;
}
nav #nav a:hover {
  cursor: pointer;
  text-decoration: none;
}
nav #nav .nav-item {
  text-align: left;
  margin-right: 5px;
}
@media (min-width: 421px) {
  nav #nav .nav-item {
    padding-left: 0 !important;
  }
}
@media (min-width: 576px) {
  nav #nav .nav-item {
    margin-right: 15px;
  }
}
nav #nav .nav-dark-light {
  padding: 5px;
  cursor: pointer;
  display: inline-flex;
  margin-right: 10px;
}
@media (max-width: 575px) {
  nav #nav .nav-dark-light {
    margin-right: 0;
  }
}
nav #nav .nav-github {
  text-align: right;
  padding-right: 0 !important;
  margin-right: 0 !important;
  display: inline-flex;
}
nav #nav .nav-github:hover img {
  filter: invert(0.4);
}
nav #nav .nav-github img {
  filter: invert(0.8);
}
nav #nav .nav-search {
  display: block;
  width: 100%;
  position: relative;
}
nav #nav .nav-search form {
  display: flex;
}
nav #nav .nav-search .nav-search__input {
  border: 0;
  font-size: 1.05rem;
  padding: 0.65rem 0.5rem;
  width: 100%;
}
nav #nav .nav-search .nav-search__input:focus {
  outline: none;
  border: 0;
}
nav #nav .nav-search #nav-search__result-container {
  position: absolute;
  max-height: 80vh;
  overflow: auto;
  width: 100%;
  border-bottom-right-radius: 5px;
  border-bottom-left-radius: 5px;
  padding: 0;
}
@media (max-width: 767px) {
  nav #nav .nav-search #nav-search__result-container {
    position: fixed;
    left: 0;
    right: 0;
    border-radius: 0;
  }
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul {
  padding: 0;
  margin: 0;
  list-style: none;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li {
  display: flex;
  padding: 10px;
  align-items: center;
  justify-content: space-between;
  overflow: hidden;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__icon .fontello-icon {
  font-size: 1.4rem;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content {
  padding: 0 10px;
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content h3 {
  margin: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li .item__content h3 a {
  white-space: inherit;
  padding: 0;
  text-align: left;
  font-weight: normal;
  font-size: 15px;
  line-height: 1.5;
  margin: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  display: block;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul li p {
  text-align: left;
  margin: 0;
  line-height: 1.5;
  font-size: 0.95rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul .enter {
  width: 20px;
  display: none;
}
nav #nav .nav-search #nav-search__result-container ul#nav-search__ul.selected .enter {
  display: block;
}
nav #nav .nav-search #nav-search__result-container mark {
  background: none;
  color: inherit;
  box-shadow: inset 0 -3px 0 0 #fff;
}
nav #nav .nav-search #nav-search__no-result {
  padding: 0 10px;
}
nav #nav .nav-search #nav-search__no-result p {
  text-align: left;
}

nav.nav-shadow {
  -webkit-box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.51);
  -moz-box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.51);
  box-shadow: 0px 0px 13px 0px rgba(0, 0, 0, 0.51);
}

/*! purgecss end ignore */
footer {
  font-size: 1rem;
  background: --color-bg-nav;
  padding: 0.75rem 1rem;
  text-align: center;
  color: #bbb;
}
footer a {
  color: #bbb;
}
footer a:hover {
  color: #fff;
  border: none;
}
footer div.social {
  margin-top: 0.5rem;
  margin-bottom: 1.5rem;
}
footer div.social a {
  margin-right: 10px;
}
footer div.social a:last-child {
  margin-right: 0;
}
@media (min-width: 992px) {
  footer div.social a {
    margin-right: 20px;
  }
}
footer div.social a img {
  display: inherit;
}

.badge {
  display: inline-flex;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: 0.25rem;
  padding: 3px 5px;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 0 !important;
}
.badge.black {
  margin: 5px;
  border: 1px solid var(--badge-black-bd);
  background: var(--badge-black-bg);
}
.badge.badge-blue {
  background: var(--badge-blue);
  color: #fff;
}
.badge.badge-green {
  background: var(--badge-green);
  color: #fff;
}
.badge.badge-yellow {
  background: #b57f07;
  color: #fff;
}
.badge.badge-pink {
  background: #c12f79bf;
  color: #fff;
}
.badge img {
  margin-right: 5px;
}
.badge picture {
  display: inline-flex;
}

.button {
  padding: 12px 20px;
  font-size: 0.85rem;
  font-weight: 500;
  transition: all 0.5s;
  letter-spacing: 2px;
  color: #fff;
  box-shadow: none;
  text-transform: capitalize;
  outline: none !important;
  border-radius: 0px;
  position: relative;
  overflow: hidden;
  border-radius: 0.3rem;
  text-transform: uppercase;
  display: inline-table;
}
.button.blue {
  background-color: #2387e2;
}
.button.blue:hover {
  background: #0c60ad;
}
.button.red {
  background-color: #e45353;
}
.button.black {
  border: 1px solid #555;
}
.button.black:hover {
  background: #333;
}

.info,
.success,
.danger,
.warning {
  position: relative;
  padding: 15px;
  margin-bottom: 22.5px;
  border: 1px solid transparent;
  border-radius: 0.25rem;
  color: var(--font-color);
  border-left-width: 15px;
}
.info *:last-child,
.success *:last-child,
.danger *:last-child,
.warning *:last-child {
  margin-bottom: 0;
}

.info {
  border-color: var(--color-blue);
}

.success {
  border-color: var(--color-green);
}

.danger {
  border-color: #ff5555;
}

.warning {
  border-color: var(--color-yellow);
}

kbd {
  background: #3c3c3c;
  color: #fff;
  border: 1px solid #444;
  border-radius: 3px;
  display: inline-block;
  margin: 0 0.1em;
  padding: 0.1em 0.2em;
  font-weight: 400;
  line-height: 1.4;
  font-size: 0.8rem;
  box-shadow: 1px 3px 0 0 #8c8c8c, 1px 1px 0 0 #8c8c8c, 1px 1px 0 0 #000;
  text-shadow: 1px 1px #000;
}

.code-output-flex {
  margin-bottom: 22.5px;
}
.code-output-flex > * {
  margin-bottom: 0 !important;
  overflow: auto;
}
.code-output-flex > *:first-child > code {
  border-bottom-right-radius: 0%;
  border-bottom-left-radius: 0%;
  height: 100%;
}
@media (max-width: 768px) {
  .code-output-flex > *:first-child > code {
    border-bottom: none;
  }
}
.code-output-flex > *:last-child > code {
  background: #252731;
  border-color: #3a3a3a80;
  height: 100%;
  white-space: pre-wrap;
}
@media (max-width: 768px) {
  .code-output-flex > *:last-child > code {
    border-top: none;
    border-top-right-radius: 0%;
    border-top-left-radius: 0%;
  }
}
@media (min-width: 768px) {
  .code-output-flex {
    display: flex;
    display: -ms-flexbox;
    margin-bottom: 22.5px;
  }
  .code-output-flex > * {
    flex: 1 1 auto;
    margin: 0 !important;
  }
  .code-output-flex > *:first-child > code {
    border-top-right-radius: 0%;
    border-bottom-right-radius: 0%;
    border-right: none;
  }
  .code-output-flex > *:last-child > code {
    border-top-left-radius: 0%;
    border-bottom-left-radius: 0%;
    border-left: none;
  }
}

.code-output-equal {
  margin-bottom: 22.5px;
}
.code-output-equal > * {
  margin-bottom: 0 !important;
  overflow: auto;
}
.code-output-equal > *:first-child > code {
  border-bottom-right-radius: 0%;
  border-bottom-left-radius: 0%;
  height: 100%;
}
@media (max-width: 768px) {
  .code-output-equal > *:first-child > code {
    border-bottom: none;
  }
}
.code-output-equal > *:last-child > code {
  background: #252731;
  border-color: #3a3a3a80;
  height: 100%;
  white-space: pre-wrap;
}
@media (max-width: 768px) {
  .code-output-equal > *:last-child > code {
    border-top: none;
    border-top-right-radius: 0%;
    border-top-left-radius: 0%;
  }
}
@media (min-width: 768px) {
  .code-output-equal {
    display: flex;
    display: -ms-flexbox;
    margin-bottom: 22.5px;
  }
  .code-output-equal > * {
    flex: 1;
    margin: 0 !important;
  }
  .code-output-equal > *:first-child > code {
    border-top-right-radius: 0%;
    border-bottom-right-radius: 0%;
    border-right: none;
  }
  .code-output-equal > *:last-child > code {
    border-top-left-radius: 0%;
    border-bottom-left-radius: 0%;
    border-left: none;
  }
}

@media (min-width: 768px) {
  .code-2cols,
.col-2-equal {
    display: flex;
    align-items: stretch;
    flex-wrap: wrap;
  }
  .code-2cols > *,
.col-2-equal > * {
    flex: 0 0 50%;
    max-width: 50%;
    overflow: auto;
  }
  .code-2cols > *:nth-child(even),
.col-2-equal > *:nth-child(even) {
    padding-left: 5px;
  }
  .code-2cols > *:nth-child(odd),
.col-2-equal > *:nth-child(odd) {
    padding-right: 5px;
  }
  .code-2cols > * > code,
.col-2-equal > * > code {
    height: 100%;
  }
  .code-2cols + h2,
.code-2cols + h3,
.code-2cols + h4,
.col-2-equal + h2,
.col-2-equal + h3,
.col-2-equal + h4 {
    margin-top: 11.25px;
  }

  .col-2-flex {
    display: flex;
    align-items: stretch;
    flex-wrap: nowrap;
  }
  .col-2-flex > * {
    flex: 1 1 auto;
    max-width: auto;
    overflow: auto;
  }
  .col-2-flex > *:nth-child(even) {
    padding-left: 5px;
  }
  .col-2-flex > *:nth-child(odd) {
    padding-right: 5px;
  }
  .col-2-flex > * > code {
    height: 100%;
  }
  .col-2-flex + h2,
.col-2-flex + h3,
.col-2-flex + h4 {
    margin-top: 11.25px;
  }
  .col-2-flex > * {
    margin-right: 10px;
  }
  .col-2-flex > *:last-child {
    margin-right: 0;
  }
}
.columns-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  align-items: center;
  margin-bottom: 22.5px;
}
@media (min-width: 576px) and (max-width: 767px) {
  .columns-2 {
    grid-template-columns: 2fr 1fr;
  }
  .columns-2.size-1-1 {
    grid-template-columns: 1fr 1fr !important;
  }
}
@media (max-width: 575px) {
  .columns-2 {
    display: block;
  }
}
@media (min-width: 768px) {
  .columns-2.size-2-1 {
    grid-template-columns: 2fr 1fr;
  }
  .columns-2.size-1-2 {
    grid-template-columns: 1fr 2fr;
  }
  .columns-2.size-3-2 {
    grid-template-columns: 3fr 2fr;
  }
  .columns-2.size-2-3 {
    grid-template-columns: 2fr 3fr;
  }
  .columns-2.size-1-1 {
    grid-template-columns: 1fr 1fr !important;
  }
}
@media (min-width: 576px) {
  .columns-2 > *:nth-child(1) {
    padding-right: 5px;
    margin-bottom: 0;
  }
  .columns-2 > *:nth-child(1) > *:last-child {
    margin-bottom: 0;
  }
  .columns-2 > *:nth-child(2) {
    padding-left: 5px;
    margin-bottom: 0;
  }
  .columns-2 > *:nth-child(2) > *:last-child {
    margin-bottom: 0;
  }
}

/*! purgecss start ignore */
.hsbox {
  margin-bottom: 22.5px;
  border: 1px solid var(--toc-title-bd);
  padding: 1rem;
  border-radius: 3px;
}
.hsbox .hs__title {
  cursor: pointer;
}
.hsbox .hs__title::before {
  content: " ";
  color: var(--color-faded);
  display: inline-block;
  border-top: 7px solid transparent;
  border-bottom: 7px solid transparent;
  border-left: 7px solid currentColor;
  vertical-align: middle;
  margin-right: 0.7rem;
  transform: translateY(-2px);
  transition: transform 0.2s ease-out;
}
.hsbox .hs__title.show {
  padding-bottom: 15px;
  border-bottom: 0.5px solid var(--toc-title-bd);
  margin-bottom: 1rem;
}
.hsbox .hs__title.show + .hs__content {
  display: block;
  opacity: 1;
  padding: 5px 0;
  transition: all 0.25s 0s cubic-bezier(0.4, 0, 0.2, 1);
}
.hsbox .hs__title.show::before {
  transform: rotate(90deg) translateX(-3px);
}
.hsbox .hs__content {
  display: none;
  transition: all 0.2s 0s ease;
}
.hsbox .hs__content > *:last-child {
  margin-bottom: 0;
}

/*! purgecss end ignore */
table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 22.5px;
  background-color: transparent;
  border-spacing: 0;
  border-radius: 3px;
  padding: 0 !important;
  table-layout: fixed;
  overflow: hidden;
  font-size: 0.95rem;
  border: 1px solid var(--toc-title-bd);
}
table th {
  font-weight: 600;
  color: var(--font-bold-color);
  text-align: left;
}
table thead > tr:first-child > th:first-child {
  border-top-left-radius: 5px;
}
table thead > tr:first-child > th:last-child {
  border-top-right-radius: 5px;
}
table th,
table td {
  border-bottom: 1px solid var(--toc-title-bd);
  padding: 5px 7px;
}
table tbody > tr:nth-child(odd) {
  background: var(--table-bg);
}
table tbody > tr:last-child {
  border-bottom: none;
}
table tbody > tr:last-child td {
  border-bottom: none;
}

@media (min-width: 768px) {
  .col-2-list,
.two-columns-list {
    column-count: 2;
    -webkit-column-count: 2;
    -moz-column-count: 2;
    -moz-column-count: 2;
  }
  .col-2-list > li,
.two-columns-list > li {
    padding-right: 10px;
  }
}

blockquote {
  margin: 0;
  margin-bottom: 1.5rem;
  padding-left: 1rem;
  border-left: 5px solid #aaa;
}

input[type=text]::-ms-clear {
  display: none;
  width: 0;
  height: 0;
}

input[type=text]::-ms-reveal {
  display: none;
  width: 0;
  height: 0;
}

input[type=search]::-webkit-search-decoration,
input[type=search]::-webkit-search-cancel-button,
input[type=search]::-webkit-search-results-button,
input[type=search]::-webkit-search-results-decoration {
  display: none;
}

.eq {
  display: inline-block;
}

.eqn {
  display: block;
}

section.eqn {
  margin-bottom: 22.5px;
}

section.eqno {
  display: flex;
  flex-direction: row;
  align-content: space-between;
  align-items: center;
}

section.eqno > eqn {
  width: 100%;
  margin-left: 3em;
}

section.eqno > span {
  width: 3em;
  text-align: right;
}

/*! purgecss start ignore */
.post-container {
  padding-top: 2.5rem;
  padding-bottom: 3rem;
}

.page-note .p-list > * {
  margin-bottom: 1rem;
}
.page-note .list-item {
  border: 1px solid #424242;
  border-radius: 3px;
  padding: 1rem;
  margin-bottom: 22.5px;
}
.page-note .list-item > *:last-child {
  margin-bottom: 0;
}
.page-note .text-center {
  text-align: center;
}
.page-note p {
  margin-top: 0;
  margin-bottom: 22.5px;
}
.page-note p + ul, .page-note p + ol {
  margin-top: -0.5rem;
}
.page-note ul, .page-note ol {
  margin-top: 0;
  margin-bottom: 22.5px;
}
.page-note ul li, .page-note ol li {
  margin-bottom: 5px;
}
.page-note ul li ul, .page-note ul li ol, .page-note ol li ul, .page-note ol li ol {
  margin-bottom: 5px;
  margin-top: 5px;
  padding-left: 20px;
}
.page-note ul li > *:not(span), .page-note ol li > *:not(span) {
  margin-bottom: 10px;
}
.page-note p.noindent {
  display: none;
  padding-left: 20px;
}
.page-note p.noindent + ul, .page-note p.noindent + ol {
  padding-left: 20px;
  margin-top: 0;
}
.page-note p.indent {
  display: none;
  padding-left: 40px;
}
.page-note p.indent + ul, .page-note p.indent + ol {
  padding-left: 40px;
}
.page-note ul.indent, .page-note ol.indent {
  padding-left: 40px;
}
.page-note ul.noindent, .page-note ol.noindent {
  padding-left: 20px;
}
.page-note hr {
  border-bottom: 1px solid var(--color-faded-invert);
  margin-bottom: 22.5px;
  margin-right: auto;
  margin-left: 0;
  width: 200px;
}
.page-note p.katex-block {
  overflow-x: auto;
  overflow-y: hidden;
}
.page-note p.katex-block .katex-display {
  margin: 0 !important;
}

#reading-list .item .author {
  font-style: italic;
}
#reading-list .item .intro {
  color: var(--color-faded);
}

/*! purgecss end ignore */
pre[class*=language-],
code[class*=language-] {
  color: #eee;
  font-size: 16px;
  text-shadow: none;
  font-family: Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace;
  direction: ltr;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  line-height: 1.5;
  -moz-tab-size: 2;
  -o-tab-size: 2;
  tab-size: 2;
  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

pre[class*=language-]::selection,
code[class*=language-]::selection,
pre[class*=language-] *::selection,
code[class*=language-] *::selection {
  text-shadow: none;
  background: #75a7ca;
}

@media print {
  pre[class*=language-],
code[class*=language-] {
    text-shadow: none;
  }
}
:not(pre) > code[class*=language-] {
  padding: 0.1em 0.3em;
  border-radius: 0.3em;
  color: #db4c69;
  background: #f9f2f4;
}

/*********************************************************
* Tokens
*/
.namespace {
  opacity: 0.7;
}

.token.doctype .token.doctype-tag {
  color: #90cdff;
}

.token.doctype .token.name {
  color: #9cdcfe;
}

.token.comment,
.token.prolog {
  color: #6a9955;
}

.token.punctuation,
.language-html .language-css .token.punctuation,
.language-html .language-javascript .token.punctuation {
  color: #eee;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.inserted,
.token.unit {
  color: #b5cea8;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.deleted {
  color: #ce9178;
}

.language-css .token.string.url {
  text-decoration: underline;
}

.token.operator,
.token.entity {
  color: #eee;
}

.token.operator.arrow {
  color: #90cdff;
}

.token.atrule {
  color: #ce9178;
}

.token.atrule .token.rule {
  color: #c586c0;
}

.token.atrule .token.url {
  color: #9cdcfe;
}

.token.atrule .token.url .token.function {
  color: #efefac;
}

.token.atrule .token.url .token.punctuation {
  color: #eee;
}

.token.keyword {
  color: #90cdff;
}

.token.keyword.module,
.token.keyword.control-flow {
  color: #c586c0;
}

.token.function,
.token.function .token.maybe-class-name {
  color: #efefac;
}

.token.regex {
  color: #d16969;
}

.token.important {
  color: #90cdff;
}

.token.italic {
  font-style: italic;
}

.token.constant {
  color: #9cdcfe;
}

.token.class-name,
.token.maybe-class-name {
  color: #4ec9b0;
}

.token.console {
  color: #9cdcfe;
}

.token.parameter {
  color: #9cdcfe;
}

.token.interpolation {
  color: #9cdcfe;
}

.token.punctuation.interpolation-punctuation {
  color: #90cdff;
}

.token.boolean {
  color: #90cdff;
}

.token.property,
.token.variable,
.token.imports .token.maybe-class-name,
.token.exports .token.maybe-class-name {
  color: #9cdcfe;
}

.token.selector {
  color: #d7ba7d;
}

.token.escape {
  color: #d7ba7d;
}

.token.tag {
  color: #90cdff;
}

.token.tag .token.punctuation {
  color: #808080;
}

.token.cdata {
  color: #808080;
}

.token.attr-name {
  color: #9cdcfe;
}

.token.attr-value,
.token.attr-value .token.punctuation {
  color: #ce9178;
}

.token.attr-value .token.punctuation.attr-equals {
  color: #eee;
}

.token.entity {
  color: #90cdff;
}

.token.namespace {
  color: #4ec9b0;
}

/*********************************************************
* Language Specific
*/
pre[class*=language-javascript],
code[class*=language-javascript],
pre[class*=language-jsx],
code[class*=language-jsx],
pre[class*=language-typescript],
code[class*=language-typescript],
pre[class*=language-tsx],
code[class*=language-tsx] {
  color: #9cdcfe;
}

pre[class*=language-css],
code[class*=language-css] {
  color: #ce9178;
}

pre[class*=language-html],
code[class*=language-html] {
  color: #eee;
}

.language-regex .token.anchor {
  color: #efefac;
}

.language-html .token.punctuation {
  color: #808080;
}

/*********************************************************
* Line highlighting
*/
pre[data-line] {
  position: relative;
}

pre[class*=language-] > code[class*=language-] {
  position: relative;
  z-index: 1;
}

.line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: #f7ebc6;
  box-shadow: inset 5px 0 0 #f7d87c;
  z-index: 0;
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre,
code {
  font-family: Consolas, Menlo, Monaco, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", "Courier New", Courier, monospace;
  line-height: 1.5;
}

h2 > code {
  font-size: 19.8px !important;
}

h3 > code {
  font-size: 17.226px !important;
}

h4 > code {
  font-size: 15.5034px !important;
}

*:not(pre) > code {
  border: var(--code-inline-bd);
  background: var(--code-inline-background);
  padding: 2px 4px;
  margin: 0 1px;
  border-radius: 3px;
  font-size: 0.9rem;
  color: var(--code-inline-text);
  word-break: break-word;
}

h2 > code,
h3 > code,
h4 > code {
  color: var(--code-inline-text);
  padding-right: 6px;
}

a > code {
  color: var(--font-a);
}
a:hover > code {
  color: var(--code-inline-text);
}

pre[class*=language-],
pre {
  margin: 0 0 24.75px 0;
  overflow: auto;
}
pre[class*=language-] > code,
pre > code {
  display: block;
  padding: 13px 15px 15px;
  background: #2f3240;
  border: 0.5px solid #3b3e54;
  overflow: auto;
  border-radius: 3px;
  max-height: 450px;
  color: #eee;
}

.highlight-line {
  display: block;
  text-decoration: none;
  /* override del, ins, mark defaults */
  color: inherit;
  /* override del, ins, mark defaults */
}
.highlight-line:empty:before {
  content: " ";
}
.highlight-line + br {
  display: none;
}

/* allow highlighting empty lines */
/* avoid double line breaks when using display: block; */
.highlight-line-isdir {
  color: #b0b0b0;
  background-color: #222;
}

.highlight-line-active {
  background-color: #444;
  background-color: rgba(69, 69, 69, 0.8);
}

.highlight-line-add {
  background-color: #45844b;
}

.highlight-line-remove {
  background-color: #902f2f;
}

.highlight-line-active,
.highlight-line-add,
.highlight-line-remove {
  margin-left: -15px;
  margin-right: -15px;
}

/*! purgecss start ignore */
.toc-common {
  font-size: 90%;
}
.toc-common li a {
  color: var(--color-faded);
}
.toc-common li:hover a {
  color: var(--color-invert);
}
.toc-common li > ol {
  margin-bottom: 5px !important;
}

.toc-active > a {
  color: var(--color-invert) !important;
  font-weight: bold;
}
.toc-active::before {
  color: var(--color-invert) !important;
  font-weight: bold;
}

.toc {
  padding: 15px;
}
.toc > ol::before {
  content: "In this note";
  display: block;
  font-family: "Inter var", "Inter", Arial, Helvetica, sans-serif;
  margin: 0;
  padding-bottom: 5px;
  border-bottom: 1px solid var(--toc-title-bd);
  margin-bottom: 10px;
  font-size: 1.15rem;
  color: var(--toc-title);
}
@media (min-width: 576px) and (max-width: 1299px) {
  .toc > ol::before {
    margin-top: -3rem;
  }
}
.toc > ol {
  padding-left: 0;
  margin-bottom: 0;
  column-count: 1;
  -webkit-column-count: 1;
  -moz-column-count: 1;
  -moz-column-count: 1;
  counter-reset: item;
  list-style-type: none;
}
@media (min-width: 576px) and (max-width: 1299px) {
  .toc > ol {
    column-count: 2;
    -webkit-column-count: 2;
    -moz-column-count: 2;
    -moz-column-count: 2;
  }
}
.toc > ol > li:first-child {
  margin-top: 0;
}
.toc > ol li {
  margin-bottom: 5px;
}
.toc > ol li code {
  font-size: 0.85rem;
  background: #ececec;
  padding: 0 4px 2px 4px;
}
.toc > ol li ol {
  padding-left: 10px;
  overflow: hidden;
  transition: all 300ms ease-in-out;
  box-shadow: inset 0.5px 0 0 0px var(--color-faded);
  margin-left: 5px;
}
.toc > ol ol {
  counter-reset: item;
  list-style-type: none;
}
.toc > ol li::before {
  content: counters(item, ".") ". ";
  counter-increment: item;
  color: var(--color-faded);
}
@media (max-width: 1299px) {
  .toc {
    margin-bottom: 22.5px;
    border: 3px double var(--color-faded);
  }
}
@media (min-width: 576px) and (max-width: 1299px) {
  .toc {
    padding-top: 4rem;
  }
}
@media (min-width: 1300px) {
  .toc {
    float: right;
    width: calc((100vw - 900px) / 2 - 20px);
    padding-top: 0;
    margin-right: calc((900px - 100vw) / 2);
    border-left: none;
    position: -webkit-sticky;
    position: sticky;
    top: 60px;
    max-height: calc(100vh - 80px);
    overflow: auto;
  }
  .toc ol {
    margin-top: 0;
    margin-bottom: 0;
  }
  .toc ol li ol {
    max-height: 0;
    margin-bottom: 0;
  }
  .toc ol li.h2-focused > ol {
    max-height: 1000px;
  }
}

/*! purgecss end ignore */
.page-note img {
  height: auto;
  width: 100%;
}
.page-note img.bg-white {
  background: #fff;
}
@media (min-width: 768px) {
  .page-note .img-full-30,
.page-note .img-30 {
    width: 30%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-35,
.page-note .img-35 {
    width: 35%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-40,
.page-note .img-40 {
    width: 40%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-45,
.page-note .img-45 {
    width: 45%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-50,
.page-note .img-50 {
    width: 50%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-55,
.page-note .img-55 {
    width: 55%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-60,
.page-note .img-60 {
    width: 60%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-65,
.page-note .img-65 {
    width: 65%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-70,
.page-note .img-70 {
    width: 70%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-75,
.page-note .img-75 {
    width: 75%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-80,
.page-note .img-80 {
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-85,
.page-note .img-85 {
    width: 85%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-90,
.page-note .img-90 {
    width: 90%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-95,
.page-note .img-95 {
    width: 95%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
  .page-note .img-full-100,
.page-note .img-100 {
    width: 100%;
    margin-left: auto;
    margin-right: auto;
    display: block;
  }
}
.page-note p > img + br, .page-note p > picture + br {
  display: none;
}
.page-note p > img + br + em, .page-note p > picture + br + em {
  display: block;
  text-align: center;
  margin-top: 10px;
  font-size: 0.9rem;
}

/*# sourceMappingURL=main.css.map */</style><body class=bg-gray-50><script>function showContent() {
        document.body.style.visibility = 'visible';
        document.body.style.opacity = 1;
      }
      window.addEventListener('DOMContentLoaded', (event) => {
        showContent();
      });</script><header><nav class=bg-gray-50><div id=nav><a href=/ class="no-effect nav-item"><div class=md:hidden id=home-icon height=18 width=18><svg class="text-yellow-500 h-6 stroke-current w-6" fill=none viewBox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke-linecap=round stroke-linejoin=round stroke-width=2 /></svg></div><span class="text-yellow-500 font-bold font-sans hidden md:block text-xl">Sebastián Barrios</span></a><div class=nav-search id=nav-search><form><input aria-label='search notes (press "/" to focus & "ESC" to close)' autocomplete=off class="bg-gray-50 nav-search__input placeholder-gray-500 placeholder-opacity-50 text-gray-500" id=nav-search__input onfocusin=inFocus(this) placeholder='search notes (press "/" to focus & "ESC" to close)' type=search></form><div class=bg-gray-50 id=nav-search__result-container style="display: none;"><ul id=nav-search__ul></ul><div id=nav-search__no-result style="display: none;"><p>No results found.</div></div></div><a href=https://github.com/sbarrios93 class="no-effect nav-item nav-github" target=_blank><img alt=github src=/img/nav/github.svg class="keep-original fill-current text-gray-700" height=20 width=20></a></div><div id=reading-progress aria-hidden=true></div></nav><script src="/src/js/search.js?hash=1aae822ef9" defer async></script><div class=header-container><div class=header-logo><img alt="Chapter 4 - Linear Regression Models" src=/img/cats/data-science.svg class=keep-original></div><h1>Chapter 4 - Linear Regression Models</h1><div id=more-info><div id=last-modified>02-11-2021</div></div></div></header><main><article class=post-container><div class="mx-auto mt-2 normal page-note"><div class="toc toc-common toc-js"><ol><li><a href=#1.1.-linear-regression>1.1. Linear Regression #</a><ol><li><a href=#1.1.1.-the-normal-equation>1.1.1. The normal equation #</a></ol><li><a href=#1.2.-gradient-descent>1.2. Gradient Descent #</a><ol><li><a href=#1.2.1.-batch-gradient-descent>1.2.1. Batch Gradient Descent #</a><li><a href=#1.2.2.-stochastic-gradient-descent>1.2.2. Stochastic Gradient Descent #</a><li><a href=#1.2.3.-mini-batch-gradient-descent>1.2.3. Mini-batch Gradient Descent #</a></ol><li><a href=#1.3.-polynomial-regression>1.3. Polynomial Regression #</a><li><a href=#1.4.-regularized-linear-models.>1.4. Regularized Linear Models. #</a><ol><li><a href=#1.4.1.-ridge-regression>1.4.1. Ridge Regression #</a><li><a href=#1.4.2.-lasso-regression>1.4.2. Lasso Regression #</a><li><a href=#1.4.3.-elastic-net>1.4.3. Elastic Net #</a><li><a href=#1.4.4.-when-to-use-what>1.4.4. When to use what #</a><li><a href=#early-stopping>Early Stopping #</a></ol><li><a href=#logistic-regression>Logistic Regression #</a><ol><li><a href=#probabilities>Probabilities #</a><li><a href=#training-and-cost-function>Training and Cost Function #</a></ol><li><a href=#softmax-regression>Softmax Regression #</a></ol></div><p>This chapter focuses on <strong>Linear Regression Models</strong>.<p>There's basically two ways to train a linear regression model:<ol><li><strong>Closed-form equation</strong>: directly computes the model parameters that best fit the model to the training set.<li><strong>Iterative</strong>: iterative optimization called <strong>Gradient Descent</strong> that gradually tweaks the model parameters to minimize a cost function. We can break down Gradient Descent in: Batch GD, Stochastic GD and Minibatch GD.</ol><h2 id=1.1.-linear-regression tabindex=-1>1.1. Linear Regression <a href=#1.1.-linear-regression class=direct-link>#</a></h2><p>Linear models predict a target variable by computing the weighted sum of the input features (this could be a input vector $\textbf{x}$) plus a constant called the <em>bias term</em> (or <em>intercept term</em>).<p>$$\hat{y} = \theta_0 + \theta_1 \cdot x_1 + \theta_2 \cdot x_2 + \cdots + \theta_n \cdot x_n$$<p>In vectorized form:<p>$$\hat{y} = h_ \mathbf{\theta } \left( \mathbf{x} \right) = \mathbf{\theta } \cdot \mathbf{x}$$<p>To train the model, we look for the value of $\theta$ that minimizes the RMSE. But in practice we seek to minimize the MSE, because it it simpler and the value that minimizes a function $f(x)$ also minimizes the function $\sqrt[]{f(x)}$.<p>Now, recall that the MSE is equal to<p>$$MSE \left( \mathbf{X}, h_\theta \right) = \frac{1}{m_i} \sum_{i=1}^{m} \left( \mathbf{\theta }^T x^{(i)} - y^{(i)} \right) ^ 2$$<h3 id=1.1.1.-the-normal-equation tabindex=-1>1.1.1. The normal equation <a href=#1.1.1.-the-normal-equation class=direct-link>#</a></h3><p>For the linear regression there is a closed form solution to minimize the cost function, called the normal equation.<p>The values of $\theta$ that minimize the cost function is given by:<p>$$\hat{\mathbf{\theta} } = \left( \mathbf{X}^T \mathbf{X} \right) ^ {-1} \mathbf{X}^T \mathbf{y}$$<blockquote><p><strong>A note on computational complexity</strong><br>The normal equation computes the inverse of $\mathbf{X}^T \mathbf{X}$ which is an (n + 1) x (n + 1) matrix. The computational complexity of inverting a matrix like that is roughly $\mathcal{O} \left( n^{2.3} \right) \text{to}, \mathcal{O} \left( n^3 \right)$. In other words, by doubling the number of features, the computation time increases to 5.3 to 8 times.</blockquote><h2 id=1.2.-gradient-descent tabindex=-1>1.2. Gradient Descent <a href=#1.2.-gradient-descent class=direct-link>#</a></h2><p>Iterative process that tweaks the parameters to minimize the cost function. Gradient Descent works by measuring the local gradient of the error function and it follows the direction of the descending gradient. The process ends when it reaches a minimum.<p>Before the first step, the vector $\vec{\theta }$ is randomly initialized (i.e. filled with random values).<p><img alt="Gradient Descent Representation" src=/img/post/homl---chapter-4/gradient-descent-1.png><br>A simple representation of Gradient Descent<p>One important part of Gradient Descent is the size of each step (each iteration) - this is determined by the <strong>learning rate</strong> hyperparameter. If the learning rate is too small, the algorithm will take too many iterations to converge. If the learning rate is too high, the algorithm might jump all over the place, and may even go to points with a higher cost than you were before. This will possibly make the algorithm to diverge.<p>It is important to note that not necessarily Gradient Descent will find the global minimum, it could very well be that it only converges to the local minimum.<p>Fortunately, the MSE is a convex function, so we know that it will only have one minimum: the global minimum.<p>To implement Gradient Descent, we need to compute the gradient of the cost function with respect to each model parameter $\theta _j$.<br>The partial derivative w.r.t $\theta _j$ is<p>$$\frac{\partial }{\partial \theta <em>j} MSE \left( \mathbf{\theta } \right) = \frac{2}{m} \sum</em>{i=1}^{m} \left( \mathbf{\theta} ^T \mathbf{x} ^{(i)} - y ^{(i)} \right) x_j^{(i)}$$<h3 id=1.2.1.-batch-gradient-descent tabindex=-1>1.2.1. Batch Gradient Descent <a href=#1.2.1.-batch-gradient-descent class=direct-link>#</a></h3><p>Batch Gradient Descent will calculate at each step the gradients for all the parameters and for all the training set. This makes it terribly slow for very large datasets, but it actually performs better than other algorithms when there are a large number of feature.<p>The full gradient vector of the cost function will be:<p>$$\nabla _\theta MSE \left( \theta \right) =<br>\begin{bmatrix}<br>\frac{\partial }{\partial \theta_0 } MSE \left( \theta \right) \<br>\frac{\partial }{\partial \theta_1 } MSE \left( \theta \right) \<br>\frac{\partial }{\partial \theta_2 } MSE \left( \theta \right) \<br>\vdots \<br>\frac{\partial }{\partial \theta_n } MSE \left( \theta \right) \<br>\end{bmatrix}$$<p>Now, keep in mind that the gradient vector points uphill, so we actually subtract this from $\theta$ to take the next step.<p>Let $\eta$ be the learning rate, then<p>$$\theta^{(\text{next step})} = \mathbf{\theta } - \eta \nabla _ \theta MSE \left( \theta \right)$$<h3 id=1.2.2.-stochastic-gradient-descent tabindex=-1>1.2.2. Stochastic Gradient Descent <a href=#1.2.2.-stochastic-gradient-descent class=direct-link>#</a></h3><p>Stochastic Gradient Descent differs from Batch Gradient Descent in that it picks a single instance of the training set at every step and computes the gradient based only on that single instance.<p>Working on a single instance at a time, it it much faster than BGD. While using less memory (it only needs to hold a single training example in memory), it is a good algorithm if one needs to train on a huge data set.<p>Now, because it is stochastic, the algorithm is much less regular than Batch Gradient Descent. It will decrease and get close to the minimum, but it will continue hovering around it. This algorithm will most likely never reach the optimum, as Batch Gradient Descent will.<p>An advantage of SGD is that it has a better chance than Batch Gradient Descent of getting out of a local minimum (and finding the global minimum) because the path that follows Stochastic Gradient Descent is much more irregular.<p>A way to fix the issue of hovering around the minimum is to use what is called a <strong>learning schedule</strong><p>With a learning schedule, we reduce the learning rate after each iteration. We start out with a large training rate (to get better odds of escaping local minima) and then reduce the training rate to allow the algorithm to settle at the global minimum.<h3 id=1.2.3.-mini-batch-gradient-descent tabindex=-1>1.2.3. Mini-batch Gradient Descent <a href=#1.2.3.-mini-batch-gradient-descent class=direct-link>#</a></h3><p>Mini-batch gradient descent is a combination of SGD and BGD. It computes the gradientes in subsets of the training set called mini batches. Because it uses more examples per iteration than SGD it is les erratic on its path toward optimum, but it also has less chance of "jumping out" of a local minima than Stochastic Gradient Descent.<h2 id=1.3.-polynomial-regression tabindex=-1>1.3. Polynomial Regression <a href=#1.3.-polynomial-regression class=direct-link>#</a></h2><p>Polynomial regression is used to answer the question of what happens if the data is more complex than a straight line.<p>In this case, we add powers to each feature as new features, and then we train the model including these extended features.<p>Now, the degree of the polynomial $k$ will be the one that that fits the data better. With a low value of $k$, odds are we will underfit the data, and with a large $k$ we run the risk of overfitting.<p>It is useful to note that when there are multiple features, the polynomial regression is capable of finding relationships between features that the Linear Regression can't.<blockquote><p><strong>The Bias/Variance trade-off.</strong><br>We can express a model's generalization error as the sum of three different errors.<ol><li>Bias: Due to wrong assumptions (e.g. assuming the data is linear when it is actually quadratic). <strong>A high bias model is most likely to underfit the training data</strong><li>Variance: Due to a model's excessive sensitivity to small variations in the training data. This is common in models with many degrees of freedom, inducing the algorithm to overfit the training data.<li>Irreducible error: Due to noisiness of the data. The way to reduce this error is to clean up the data.</ol></blockquote><h2 id=1.4.-regularized-linear-models. tabindex=-1>1.4. Regularized Linear Models. <a href=#1.4.-regularized-linear-models. class=direct-link>#</a></h2><p>A common way to reduce overfitting is to regularize the data (i.e. to constrain it). This can be done simply by reducing the number of polynomial degrees.<h3 id=1.4.1.-ridge-regression tabindex=-1>1.4.1. Ridge Regression <a href=#1.4.1.-ridge-regression class=direct-link>#</a></h3><p>Ridge regression is a form of regularized Linear regression, where a regularization term is added to the cost function, where the regularization term is<br>$$\alpha \sum_{i=1}^{n} \theta _i ^ {2}$$<p>By adding this term we force the algorithm to keep the weights as small as possible while fitting the data.<p><strong>Note that the regularization term should be added only during training, it should be used on evaluating the predictions on the validation/test set</strong><p>So the ridge regression cost function for the training step will be:<br>$$J(\theta ) = MSE(\theta) + \alpha \frac{1}{2} \sum_{i=1}^{n}\theta _i ^ 2$$<br><strong>Note that $\theta_0$ is not regularized</strong>.<p>It is important to note that if we let $\mathbf{w}$ be the vector of the weights $(\theta _1...\theta _n)$ then the regularization term will be equal to $\frac{1}{2} \left(\left| w \right|_2\right)^2$, where $\left| w \right| _2$ represents the $\ell _2$ norm of the weight vector.<h4 id=1.4.1.1.-the-closed-form-solution tabindex=-1>1.4.1.1. The Closed Form Solution <a href=#1.4.1.1.-the-closed-form-solution class=direct-link>#</a></h4><p>Let $\mathbf{A}$ be the identity matrix of shape $\left( n + 1 \right) \times \left( n + 1 \right)$, with the slight modification of having a 0 in the top-left cell (which is the bias term), then the closed-form solution for the Ridge Regression is:<p>$$\hat{\theta } = \left( X^TX + \alpha \mathbf{A} \right) ^ {-1} X^T \mathbf{y}$$<h3 id=1.4.2.-lasso-regression tabindex=-1>1.4.2. Lasso Regression <a href=#1.4.2.-lasso-regression class=direct-link>#</a></h3><p>THis is another regularized version of Linear Regression. In this case, the regularization therm uses the $\ell_1$ norm of the weight vector instead of the $\ell_2$<p>The cost function will be<p>$$J \left( \theta \right) = MSE \left( \theta \right) + \alpha \sum_{i=1}^{n} \mid \theta _1 \mid$$<br>Now, the Lasso Regression tendos to eliminate weights of the least important features (setting their $\theta$ to 0 ). In other words, Lasso Regression automatically performs feature selection and outputs a <em>sparse model</em>.<p>We need to be careful because the Lasso cost function is not diffrentiable at $\theta_i = 0 , \forall i$. To make Gradient Descent work, we will need a subgradient vector $\mathbf{g}$ when $\theta_i = 0$.<p>Then:<br>$$g \left( \theta , J \right) = \nabla _\theta MSE \left( \theta \right) + \alpha<br>\begin{pmatrix}<br>s(\theta_1) \<br>s(\theta_2) \<br>\vdots \<br>s(\theta_n)<br>\end{pmatrix} \text{where } s(\theta_i) = \begin{cases}<br>-1 &\text{if } \theta_i &lt; 0\<br>0 &\text{if } \theta_i = 0\<br>1 &\text{if } \theta_i > 0<br>\end{cases}$$<h3 id=1.4.3.-elastic-net tabindex=-1>1.4.3. Elastic Net <a href=#1.4.3.-elastic-net class=direct-link>#</a></h3><p>This is a combination of using Ridge Regression and Lasso Regression. Where the mix is controlled by the mix ratio $r$. When $r = 0$ then Elastic Net is the same as Ridge Regression and when $r = 1$ it is equal to Lasso Regression.<p>$$J(\theta ) = MSE (\theta) + r \alpha \sum_{i = 1}^{n } \mid \theta <em>i \mid + \frac{1-r}{2} \alpha \sum</em>{i=1}^{n} \theta ^ 2 _ i$$<h3 id=1.4.4.-when-to-use-what tabindex=-1>1.4.4. When to use what <a href=#1.4.4.-when-to-use-what class=direct-link>#</a></h3><p>Ridge is a good default, but if you suspect that some features are not useful, Elastic Net or Lasso Regression may be better. In general Elastic Net is preferred over Lasso because Lasso may behave erratically when the number of features is greater than the number of training instances or when several features may be strongly correlated.<h3 id=early-stopping tabindex=-1>Early Stopping <a href=#early-stopping class=direct-link>#</a></h3><p>This is a different way of regularizing an algorithm, in which we stop the training as soon as the <strong>validation</strong> error reaches a minimum.<br>As the epochs go by, and the prediction error goes down, the prediction on the validation set should go down as well.<p>This is only up to a point. After a while, the validation error may stop decreasing and start going up. This would mean that <strong>the training model has start to overfit the data</strong>.<p>With early stopping we just stop training as soon as the validation error reaches the minimum.<blockquote><p>With Stochastic and Mini-batch the curves will not be smooth, so it may be hard to know whether we have reached the minimum or not. One solution is to stop only after the validation error has been above the minimum for some time, then roll back the model parameters to the point where the validation error was at a minimum.</blockquote><h2 id=logistic-regression tabindex=-1>Logistic Regression <a href=#logistic-regression class=direct-link>#</a></h2><p>Some models can be used for classification as well as regression. One of the most common ones is Logistic Regression, which is used to estimate the probability that an instance belongs to a particular class.<p>If the probability is greater than 50%, then the model predicts that the instance belongs to that class. Otherwise it doesn't belong to that class.<p>More formally:<p>Let $k$ be the classes where $k = \left{ 0,1 \right}$ meaning that if $k = 1$ then it belongs to the class and if $k = 0$ then it doesn't belong to the class. Then:<br>$$\hat{k} = 1 \iff p(k = 1) \geq 0.5$$<p>The class $k = 1$ is also known as the positive class and the class $k = 0$ is known as the negative class.<h3 id=probabilities tabindex=-1>Probabilities <a href=#probabilities class=direct-link>#</a></h3><p>A Logistic Regression computes a weighted sum of the input features as seen previously (i.e. $\theta^T \mathbf{x}$ ) but it outputs the logistic of the linear function.<p>The equation is:<br>$$\hat{p} = h_\theta ( \mathbf{x}) = \sigma \left( \theta^T\mathbf{x} \right)$$ where $\sigma \left( \cdot \right)$ is the sigmoid function.<p>Then the full logistic function is<p>$$h _ \theta (x) = \sigma(\theta^T x) = \frac{1}{1 + \exp (- \theta ^T x)}$$<h3 id=training-and-cost-function tabindex=-1>Training and Cost Function <a href=#training-and-cost-function class=direct-link>#</a></h3><p>The objective is to set the parameter vector $\theta$ so that the model estimates high probabilities for a positive instance and low probability for a negative instance.<p>Then the cost function for a single training instance would be soemthing like this<br>$$c \left( \theta \right) = \begin{cases}<br>-\log{\hat{p}} &\text{if } y = 1 \<br>-\log{(1-\hat{p})} &\text{if } y = 0\<br>\end{cases}$$<p>Which makes sense because $- \log (x)$ grows very large when $x$ approaches 0, so the cost function will be large if the model estimates a probability close to 0 for a positive instance, and it will be very large if the model estimates a probability close to 1 for a negative instance.<p>Then the cost function will be, which is called the <em>log-loss</em><p>$$J (\theta) = - \frac{1}{m } \sum_{i=1}^{m }\left[ y ^{(i)} \log \left( \hat{p}^{(i)} \right) + \left( 1 - y^{(i)} \right)\log \left( 1 - \hat{p}^{(i)} \right) \right]$$<br>We know that the cost function is convex, so Gradient Descent is guaranteed to find the global minimum.<p>The partial derivatives are the following:<p>$$\frac{\partial }{\partial {\theta_j}} J \left( \theta \right) = \frac{1}{m } \sum_{i=1}^{m } \left( \sigma \left( \theta^T x ^ {(i)} \right) - y ^{(i)} \right) x_j$$<h2 id=softmax-regression tabindex=-1>Softmax Regression <a href=#softmax-regression class=direct-link>#</a></h2><p>The logistic regression can be generalized to support multiple classes directly, without having to train and combine multiple binary classifiers.<p>When given an instance $\mathbf{x}$, the softmax regression model first computes a score $s_k(\mathbf{x })$ for each class $k$, then estimates the probability for each class by applying the softmax function to the scores.<p>First, the softmax score will be<p>$$s_k \left( \mathbf{x } \right) = (\theta^T_k) \mathbf{x}$$<p><strong>Note that each class has its own dedicated parameter vector $\theta _k$</strong><p>Then we can estimate the probability $\hat{p }_k$ that the instance belongs to class $k$ by running the scores through the softmax function.<p>The softmax function computes the exponential of every score, then normalizes them so they sum to 1.<p>The softmax function is<p>$$\hat{p_k} = \sigma \left( s(x) \right)<em>k = \frac{\exp \left( s_k (x) \right) }{\sum</em>{j=1}^{k } \exp (s_j(x))}$$<p>Here $K$ is the number of classes, while $s(x)$ is a vector containing the scores of each class for the instance $x$. Finally, $\sigma \left( s \left( x \right) \right)$ is the estimated probability that the instance $x$ belongs to class k, given the scores of each class for that instance.<p>The Softmax Regression classifier predicts the class with the highest estimated probability.<p>The Classifier Prediction will be<p>$$\hat{y } = \arg \max_{k } \sigma \left( s \left( x \right) \right)<em>k = \arg \max</em>{k } s_k \left( x \right) = \arg \max_{k } \left( \theta ^T _k x \right)$$<blockquote><p>The softmax regressionis multiclass, not multioutput. Meaning that it predicts only one class at a time, so the classes should be <strong>mutually exclusive</strong>.</blockquote><p>The objective is to have a model that estimates a high probability for the target class. Minimizing the cost function (called <strong>cross entropy</strong>) we should be able to optimize for the parameters that achieve this goal.<p><strong>Cross entropy is frequently used to measure how well a set of estimated class probabilities matches the target classes</strong><p>The cross entropy cost function will be<p>$$J \left( \theta \right) = - \frac{1}{m } \sum_{i=1}^{m} \sum_{k=1}^{K } y^{(i)}_k \log \left( \hat{p }_k^{(i)} \right)$$<br>Where $y_k^{(i)}$ is the target probability that the $\imath ^{th}$ instance belongs to class $k$.<p>The gradient vector of the cost function with regards to $\theta_k$ will be:<p>$$\nabla _ {\theta_k} J (\Theta) = \frac{1}{m } \sum_{i=1}^{m }\left( \hat{p }_k ^{(i)} - y^{(i)}_k \right) x^{(i)}$$<div id=tag-footer><div id=note-tag><a href=/tags/hands-on-machine-learning/ >Hands on Machine Learning</a></div></div></div><script type=application/ld+json>{
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "Chapter 4 - Linear Regression Models",
        "image": [],
        "author": "Sebastián Barrios",
        "genre": "Insert a schema.org genre",
        "url": "https://sebabarrios.com/homl---chapter-4/",
        "mainEntityOfPage": "https://sebabarrios.com/homl---chapter-4/",
        "datePublished": "05-07-2021",
        "dateModified": "02-11-2021",
        "description": "This chapter focuses on Linear Regression Models. There&#39;s basically two ways to train a linear regression model: Closed-form equation:..."
      }</script></article></main><footer><div class="mx-auto bg-opacity-60 bg-purple-100 container flex leading-normal mb-4 mt-8 py-3 rounded" role=alert><div class="text-gray-500 px-4 text-center w-full">This website is based on the design made by <a href=https://github.com/dinhanhthi class="hover:text-purple-700 text-purple-500" target=_blank>Anh-Thi DINH</a> for his <a href=https://dinhanhthi.com class="hover:text-purple-700 text-purple-500" target=_blank>awesome website</a>.</div></div><div class=social><a href=https://github.com/sbarrios93 class=no-effect title=Github><img alt=Github src=/img/social/github.svg class=keep-original height=20 width=20> </a><a href=https://www.linkedin.com/in/sebastianbs/ class=no-effect title=LinkedIn><img alt=LinkedIn src=/img/social/linkedin.svg class=keep-original height=20 width=20> </a><a href=https://twitter.com/itsmeseba class=no-effect title=Twitter><img alt=Twitter src=/img/social/twitter.svg class=keep-original height=20 width=20></a></div><a href=/ target=_blank>Sebastián Barrios  ©  2021 </a> •  <a href=/about-the-notes/ >About the notes </a> •  <a href=/about/ >About me</a></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js></script><script src="/src/js/min.js?hash=db08ffb732" defer async></script>